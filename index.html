<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Website Security Surface Scan | Urban Sentinel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #0f1115;
      color: #e6e6e6;
      padding: 40px;
      margin: 0;
    }

    h1 { margin-bottom: 10px; }
    p { max-width: 900px; line-height: 1.6; color: #b6bcc8; }

    .box {
      background: #141821;
      padding: 24px;
      border-radius: 10px;
      max-width: 1000px;
      margin-top: 30px;
    }

    input {
      padding: 12px;
      width: 260px;
      border-radius: 6px;
      border: 1px solid #2a3140;
      background: #0f1115;
      color: #e6e6e6;
    }

    button {
      padding: 12px 18px;
      margin-left: 10px;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      background: #3b82f6;
      color: white;
    }

    button.secondary {
      background: #1f2937;
      margin-top: 10px;
    }

    button.hidden {
      display: none;
    }

    pre {
      margin-top: 20px;
      background: #0b0e14;
      padding: 20px;
      border-radius: 8px;
      white-space: pre-wrap;
      line-height: 1.5;
    }

    iframe {
      width: 100%;
      height: 600px;
      border: 1px solid #2a3140;
      border-radius: 8px;
      margin-top: 20px;
      background: white;
    }

    .footer {
      margin-top: 60px;
      font-size: 0.85rem;
      color: #8b92a8;
      max-width: 1000px;
    }
  </style>
</head>

<body>

<h1>AI-Assisted Website Security Surface Scan</h1>

<p>
This tool performs a non-intrusive, AI-assisted surface assessment of a public website.
It analyses <strong>publicly observable HTTP response headers only</strong>.
No authentication, probing, exploitation, or bypass techniques are used.
</p>

<div class="box">

  <label>Website domain</label><br /><br />

  <input id="domain" placeholder="example.com" />
  <button onclick="runScan()">Run AI surface scan</button>

  <pre id="results">Awaiting input‚Ä¶</pre>

  <button id="genPdfBtn" class="secondary hidden" onclick="generatePDF()">
    Generate report
  </button>

  <button id="dlPdfBtn" class="secondary hidden" onclick="downloadPDF()">
    Download PDF
  </button>

  <!-- PDF PREVIEW (INLINE, SAME PAGE) -->
  <iframe id="pdfPreview" class="hidden"></iframe>

</div>

<div class="footer">
<strong>Methodology & Disclaimer</strong><br />
Advisory assessment only. Based solely on publicly observable HTTP response headers.
Not a penetration test, certification, or compliance audit.
</div>

<script>
let reportText = "";
let reportDomain = "";
let pdfBlobUrl = null;

async function runScan() {
  const domainInput = document.getElementById("domain");
  const results = document.getElementById("results");
  const genBtn = document.getElementById("genPdfBtn");
  const dlBtn = document.getElementById("dlPdfBtn");
  const preview = document.getElementById("pdfPreview");

  genBtn.classList.add("hidden");
  dlBtn.classList.add("hidden");
  preview.classList.add("hidden");

  let domain = domainInput.value.trim();
  if (!domain) {
    results.textContent = "‚ùå Please enter a domain.";
    return;
  }

  if (!domain.startsWith("http")) {
    domain = "https://" + domain;
  }

  results.textContent = "ü§ñ Running AI surface scan...\n\n";

  try {
    const response = await fetch(
      "https://api.allorigins.win/raw?url=" + encodeURIComponent(domain)
    );

    const headers = response.headers;

    const checks = [
      ["Strict-Transport-Security", "HSTS"],
      ["Content-Security-Policy", "Content Security Policy"],
      ["X-Frame-Options", "Clickjacking Protection"],
      ["X-Content-Type-Options", "MIME Sniffing Protection"],
      ["Referrer-Policy", "Referrer Policy"],
      ["Permissions-Policy", "Permissions Policy"]
    ];

    let missing = 0;
    let report = "AI-Assisted Header Assessment\n\n";

    checks.forEach(([h, label]) => {
      if (headers.get(h)) {
        report += `‚úî ${label}: PRESENT\n`;
      } else {
        report += `‚ö† ${label}: NOT DETECTED\n`;
        missing++;
      }
    });

    const risk =
      missing >= 4 ? "HIGH" :
      missing >= 2 ? "MODERATE" :
      "LOW";

    report += `\nOverall surface risk level: ${risk}\n\n`;
    report +=
      "Interpretation notes:\n" +
      "- Surface-level exposure only\n" +
      "- Missing headers ‚â† confirmed vulnerabilities\n" +
      "- No intrusive testing performed\n";

    reportText = report;
    reportDomain = domain.replace(/^https?:\/\//, "");

    results.textContent = report;
    genBtn.classList.remove("hidden");

  } catch {
    results.textContent =
      "‚ùå Unable to retrieve headers.\n\n" +
      "This may be due to request blocking or network configuration.";
  }
}

function generatePDF() {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  doc.setFontSize(14);
  doc.text("Urban Sentinel", 14, 20);
  doc.text("AI-Assisted Website Security Surface Scan", 14, 30);

  doc.setFontSize(10);
  doc.text(`Domain: ${reportDomain}`, 14, 42);
  doc.text(`Generated: ${new Date().toLocaleString()}`, 14, 48);

  doc.text(reportText, 14, 60, { maxWidth: 180 });

  doc.addPage();
  doc.text(
    "Disclaimer:\n\n" +
    "This report is advisory only and based solely on publicly observable\n" +
    "HTTP response headers. It is not a penetration test or\n" +
    "compliance certification.",
    14,
    20
  );

  const blob = doc.output("blob");
  if (pdfBlobUrl) URL.revokeObjectURL(pdfBlobUrl);
  pdfBlobUrl = URL.createObjectURL(blob);

  const preview = document.getElementById("pdfPreview");
  preview.src = pdfBlobUrl;
  preview.classList.remove("hidden");

  document.getElementById("dlPdfBtn").classList.remove("hidden");
}

function downloadPDF() {
  const a = document.createElement("a");
  a.href = pdfBlobUrl;
  a.download = `urban-sentinel-ai-surface-scan-${reportDomain}.pdf`;
  a.click();
}
</script>

</body>
</html>
