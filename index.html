<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Website Security Surface Scan | Urban Sentinel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="AI-assisted, non-intrusive website security surface scan using publicly observable HTTP response headers only." />
</head>

<body style="font-family:system-ui;background:#0f1115;color:#e6e6e6;padding:40px">

<h1>AI-Assisted Website Security Surface Scan</h1>
<p>Non-intrusive advisory assessment based on publicly observable HTTP response headers.</p>

<input id="domain" placeholder="example.com" style="padding:10px;width:260px">
<button onclick="runScan()">Run scan</button>

<pre id="output" style="margin-top:20px;background:#111;padding:20px"></pre>

<button id="viewBtn" style="display:none" onclick="viewReport()">View / Save report</button>

<script>
async function runScan() {
  const domainInput = document.getElementById("domain");
  const output = document.getElementById("output");
  const viewBtn = document.getElementById("viewBtn");

  let domain = domainInput.value.trim();
  if (!domain) {
    output.textContent = "Enter a domain.";
    return;
  }
  if (!domain.startsWith("http")) domain = "https://" + domain;

  output.textContent = "Running scan…";

  const response = await fetch(
    "https://api.allorigins.win/raw?url=" + encodeURIComponent(domain)
  );

  const headers = response.headers;
  const checks = [
    ["Strict-Transport-Security", "HSTS"],
    ["Content-Security-Policy", "CSP"],
    ["X-Frame-Options", "X-Frame-Options"],
    ["X-Content-Type-Options", "X-Content-Type-Options"],
    ["Referrer-Policy", "Referrer-Policy"],
    ["Permissions-Policy", "Permissions-Policy"]
  ];

  let missing = 0;
  let report = "";

  checks.forEach(([h, label]) => {
    if (headers.get(h)) report += `✔ ${label}\n`;
    else { report += `⚠ ${label}\n`; missing++; }
  });

  const risk = missing >= 4 ? "HIGH" : missing >= 2 ? "MODERATE" : "LOW";
  report += `\nOverall surface risk: ${risk}`;

  sessionStorage.setItem("scanReport", report);
  sessionStorage.setItem("scanDomain", domain);

  output.textContent = report;
  viewBtn.style.display = "inline-block";
}

function viewReport() {
  window.location.href = "report.html";
}
</script>

</body>
</html>
