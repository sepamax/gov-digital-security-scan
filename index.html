<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI-Assisted Website Security Surface Scan | Urban Sentinel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:system-ui;background:#0f1115;color:#e6e6e6;padding:40px;margin:0}
h1{margin-top:0}
.box{background:#141821;padding:20px;border-radius:10px;max-width:1200px;margin-top:24px}
input{padding:12px;width:260px;border-radius:6px;border:1px solid #2a3140;background:#0f1115;color:#e6e6e6}
button{padding:12px 18px;margin-left:10px;border-radius:6px;border:none;cursor:pointer;background:#3b82f6;color:white;opacity:.4}
button.enabled{opacity:1}
button.secondary{background:#1f2937}
button.hidden{display:none}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-top:18px}
pre{background:#0b0e14;padding:14px;border-radius:8px;white-space:pre-wrap;line-height:1.5;color:#cbd5f5;min-height:90px}
.hidden{display:none}

/* dots */
.dots::after{content:"";display:inline-block;width:1em;animation:ellipsis 1.4s infinite}
@keyframes ellipsis{0%{content:""}25%{content:"."}50%{content:".."}75%{content:"..."}100%{content:""}}

/* indicators */
.indicators{border:2px solid #1f2937;background:#0b0e14}
.matrix-row{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #1f2937}
.matrix-row:last-child{border-bottom:none}
.pill{font-size:12px;padding:3px 10px;border-radius:999px;font-weight:600}
.green{background:#064e3b;color:#6ee7b7}
.yellow{background:#3f2f1d;color:#fcd34d}
.red{background:#3f1d1d;color:#fca5a5}

/* glow */
.glow{margin-left:14px;color:#93c5fd;animation:pulse 2s infinite}
@keyframes pulse{0%{opacity:.5}50%{opacity:1}100%{opacity:.5}}

/* modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;z-index:999}
.modal.active{display:flex}
.modal-content{background:#fff;width:90%;max-width:1100px;height:85vh;border-radius:12px;overflow:hidden;display:flex;flex-direction:column}
.modal-header{background:#111827;color:#e5e7eb;padding:12px 16px;display:flex;justify-content:space-between}
.modal-body{flex:1}
.modal-body iframe{width:100%;height:100%;border:none}
</style>
</head>

<body>

<h1>AI-Assisted Website Security Surface Scan</h1>

<div class="box">
  <label>Website domain</label><br><br>
  <input id="domain" placeholder="e.g. yoursite.com" oninput="checkDomain()">
  <button id="scanBtn" disabled onclick="handleScan()">Run AI surface scan</button>
</div>

<div id="indicatorBox" class="box indicators hidden">
  <h2>Surface Security Indicators</h2>
  <div id="matrixRows"></div>
</div>

<div class="box">
  <div class="grid">
    <div>
      <h3>Summary for Decision-Makers</h3>
      <pre id="plainResults">Awaiting input<span class="dots"></span></pre>
    </div>
    <div>
      <h3>Technical Findings</h3>
      <pre id="techResults">Awaiting input<span class="dots"></span></pre>
    </div>
  </div>

  <div style="margin-top:18px">
    <button id="genReportBtn" class="secondary hidden" onclick="openReport()">Generate advisory report</button>
    <span id="glowText" class="glow hidden">Generate full scan results to find out more â†’</span>
  </div>
</div>

<div id="reportModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <strong>Advisory Report Preview</strong>
      <button onclick="closeReport()">Close</button>
    </div>
    <div class="modal-body">
      <iframe id="reportFrame"></iframe>
    </div>
  </div>
</div>

<script>
let scanned=false;

const BASE_INDICATORS=[
  {label:"HTTPS Transport",status:"STRONG"},
  {label:"HTTP Strict Transport Security (HSTS)",status:"MISSING"},
  {label:"Content Security Policy (CSP)",status:"MISSING"},
  {label:"Clickjacking Protection",status:"WEAK"},
  {label:"MIME Sniffing Protection",status:"MISSING"},
  {label:"Referrer Policy",status:"MISSING"},
  {label:"Permissions Policy",status:"MISSING"}
];

function validDomain(v){return /^[a-z0-9.-]+\.[a-z]{2,}$/i.test(v);}
function checkDomain(){
  if(scanned) return;
  scanBtn.disabled=!validDomain(domain.value.trim());
  scanBtn.classList.toggle("enabled",!scanBtn.disabled);
}

async function handleScan(){scanned?resetScan():await runScan();}

async function runScan(){
  const d=domain.value.trim();
  if(!validDomain(d)) return;

  scanned=true;
  scanBtn.textContent="Refresh scan";
  scanBtn.classList.add("enabled");

  sessionStorage.setItem("scanDomain",d);
  sessionStorage.setItem("scanIndicators",JSON.stringify(BASE_INDICATORS));

  const adv=await runAdvancedScans(d);

  matrixRows.innerHTML="";
  BASE_INDICATORS.forEach(i=>addRow(i.label,i.status));
  addRow("Edge / CDN Protection",adv.edgePosture);
  addRow("Geographic Exposure",adv.geoOrientation);
  addRow("Transport Security",adv.tlsPosture);

  indicatorBox.classList.remove("hidden");

  plainResults.textContent=
`This assessment reviews publicly observable security posture signals.

Surface indicators, platform exposure, and transport security characteristics
were analysed using automated inspection.

Results reflect configuration posture only.`;

  techResults.textContent=
`Edge posture: ${adv.edgePosture}
Geographic exposure: ${adv.geoOrientation}
Transport security: ${adv.tlsPosture}`;

  sessionStorage.setItem("scanSummary",plainResults.textContent);

  genReportBtn.classList.remove("hidden");
  glowText.classList.remove("hidden");
}

function resetScan(){
  scanned=false;
  domain.value="";
  scanBtn.textContent="Run AI surface scan";
  scanBtn.disabled=true;
  scanBtn.classList.remove("enabled");
  indicatorBox.classList.add("hidden");
  genReportBtn.classList.add("hidden");
  glowText.classList.add("hidden");
  plainResults.innerHTML="Awaiting input<span class='dots'></span>";
  techResults.innerHTML="Awaiting input<span class='dots'></span>";
  sessionStorage.clear();
}

function pillClass(s){
  s=s.toUpperCase();
  if(s.includes("STRONG")||s.includes("MODERN")) return "green";
  if(s.includes("WEAK")||s.includes("AGING")) return "yellow";
  if(s.includes("MISSING")||s.includes("NOT")) return "red";
  if(s.includes("MIXED")) return "yellow";
  return "green";
}

function addRow(l,v){
  const r=document.createElement("div");
  r.className="matrix-row";
  r.innerHTML=`<span>${l}</span><span class="pill ${pillClass(v)}">${v}</span>`;
  matrixRows.appendChild(r);
}

async function runAdvancedScans(domain){
  const r={edgePosture:"EDGE_NOT_OBSERVED",geoOrientation:"MIXED_ORIENTATION",tlsPosture:"AGING_TLS"};

  try{
    const f=await fetch(`https://${domain}`,{mode:"no-cors"});
    const h={}; f.headers?.forEach((v,k)=>h[k]=v.toLowerCase());
    if(h["cf-ray"]||h["cf-cache-status"]||h["server"]?.includes("cloudflare"))
      r.edgePosture="EDGE_DETECTED";
  }catch{}

  if(domain.endsWith(".com.au")||domain.endsWith(".au")) r.geoOrientation="LOCAL_ONLY";
  else if(domain.endsWith(".com")) r.geoOrientation="MIXED_ORIENTATION";

  try{
    const f=await fetch(`https://${domain}`,{cache:"no-store"});
    const exp=f.headers.get("expires");
    if(exp){
      const days=(new Date(exp)-new Date())/86400000;
      r.tlsPosture=days>30?"MODERN_TLS":"AGING_TLS";
    }
  }catch{}

  sessionStorage.setItem("edgePosture",r.edgePosture);
  sessionStorage.setItem("geoOrientation",r.geoOrientation);
  sessionStorage.setItem("tlsPosture",r.tlsPosture);

  return r;
}

function openReport(){
  reportFrame.src="report.html";
  reportModal.classList.add("active");
}
function closeReport(){
  reportModal.classList.remove("active");
  reportFrame.src="";
}
</script>

</body>
</html>
